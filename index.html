<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prime Number Research Platform | Wessen Getachew</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 50px 30px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            backdrop-filter: blur(15px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.4em;
            margin-bottom: 20px;
            opacity: 0.95;
        }

        .author-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 15px 30px;
            border-radius: 50px;
            margin: 10px;
            font-weight: bold;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .research-section {
            background: white;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid #e0e6ff;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 15px 15px 0 0;
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 20px;
            background: #6c757d;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, #007bff, #0056b3);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .tab-content {
            display: none;
            padding: 40px;
            background: white;
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
        }

        .author-info {
            background: linear-gradient(135deg, rgba(0, 123, 255, 0.1), rgba(102, 126, 234, 0.1));
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            border: 2px solid rgba(0, 123, 255, 0.2);
        }

        .detailed-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 25px 0;
            border-left: 6px solid #007bff;
        }

        .mathematical-notation {
            font-family: 'Times New Roman', serif;
            font-size: 1.2em;
            background: linear-gradient(135deg, #fff, #f8f9fa);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #007bff;
        }

        .research-highlights {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .highlight-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-top: 5px solid #007bff;
            transition: transform 0.3s ease;
        }

        .highlight-card:hover {
            transform: translateY(-5px);
        }

        .highlight-card h4 {
            color: #007bff;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .control-group {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #dee2e6;
        }

        .control-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #495057;
        }

        .control-group input, .control-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 14px;
        }

        .control-group small {
            color: #666;
            font-size: 0.9em;
            margin-top: 8px;
            display: block;
        }

        .btn {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 123, 255, 0.4);
        }

        .export-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4);
        }

        .export-controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #dee2e6;
        }

        .results {
            background: linear-gradient(135deg, #e8f5e8, #ffffff);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border-left: 6px solid #28a745;
        }

        .results h3 {
            color: #155724;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .result-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .result-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 8px;
        }

        .result-label {
            font-size: 0.9em;
            color: #6c757d;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .data-table th {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }

        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .data-table tr:hover {
            background: rgba(0, 123, 255, 0.05);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-low { background: #28a745; color: white; }
        .status-high { background: #dc3545; color: white; }
        .status-medium { background: #fd7e14; color: white; }

        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .controls { grid-template-columns: 1fr; }
            .research-highlights { grid-template-columns: 1fr; }
            .tabs { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Prime Number Research Platform</h1>
            <p class="subtitle">Interactive Mathematical Discovery Tool</p>
            <div class="author-badge">Research by <strong>Wessen Getachew</strong></div>
            <div class="author-badge">getachewwessen@gmail.com</div>
            <div style="margin-top: 20px; font-size: 1em; opacity: 0.9;">
                <span style="background: rgba(255,255,255,0.2); padding: 8px 20px; border-radius: 20px;">
                    Published: Summer 2025 • Independent Mathematical Research
                </span>
            </div>
        </div>

        <div class="research-section">
            <div class="tabs">
                <button class="tab active" onclick="showTab('twin-prime')">Twin Prime Stability</button>
                <button class="tab" onclick="showTab('identity-explorer')">Identity Explorer</button>
                <button class="tab" onclick="showTab('research-info')">Research Documentation</button>
            </div>

            <div id="twin-prime" class="tab-content active">
                <div class="author-info">
                    <h2>Twin Prime Numerical Stability Research</h2>
                    <p><strong>Novel Algebraic Factorization Method for Computational Stability</strong></p>
                    <p>By <strong>Wessen Getachew</strong> • getachewwessen@gmail.com</p>
                </div>

                <div class="mathematical-notation">
                    <strong>Breakthrough Identity:</strong><br>
                    <span style="font-size: 1.4em; color: #007bff;">(p-1)(p-2)/p² = (1-1/(p-1)²)(1-1/p)³</span>
                </div>

                <div class="detailed-info">
                    <h3>The Problem</h3>
                    <p>Twin prime research requires computing products ∏(p-1)(p-2)/p² over large prime ranges. Traditional methods suffer from catastrophic underflow beyond ~1000 primes.</p>
                </div>

                <div class="research-highlights">
                    <div class="highlight-card">
                        <h4>Numerical Stability</h4>
                        <p>1000× improvement: Stable computation for 100,000+ prime ranges</p>
                    </div>
                    <div class="highlight-card">
                        <h4>Theoretical Clarity</h4>
                        <p>Component separation: Isolates twin-specific from general prime effects</p>
                    </div>
                    <div class="highlight-card">
                        <h4>Research Applications</h4>
                        <p>Hardy-Littlewood verification: Enables testing at unprecedented scales</p>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label for="twin-range">Prime Range Limit:</label>
                        <input type="number" id="twin-range" value="5000" min="500" max="100000" step="500">
                        <small>Recommended: 1,000-5,000 for both methods; 50,000+ only factorized works</small>
                    </div>
                    <div class="control-group">
                        <label for="twin-method">Computation Method:</label>
                        <select id="twin-method">
                            <option value="both">Compare Both Methods</option>
                            <option value="direct">Direct Method Only</option>
                            <option value="factorized">Factorized Method Only</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn" onclick="computeTwinPrimeStability()">
                        Compute Twin Prime Stability Analysis
                    </button>
                    
                    <div class="export-controls">
                        <h4 style="margin-bottom: 15px;">Export Results:</h4>
                        <button class="export-btn" onclick="exportResults('csv')">CSV Data</button>
                        <button class="export-btn" onclick="exportResults('json')">JSON</button>
                        <button class="export-btn" onclick="exportResults('report')">Research Report</button>
                    </div>
                </div>

                <div class="loading" id="twin-loading">
                    <div class="spinner"></div>
                    <p>Computing twin prime stability analysis...</p>
                </div>

                <div id="twin-results" class="results" style="display: none;">
                    <h3>Twin Prime Stability Analysis Results</h3>
                    <div id="twin-results-content"></div>
                </div>
            </div>

            <div id="identity-explorer" class="tab-content">
                <div class="author-info">
                    <h2>Identity Explorer & Verification Tool</h2>
                    <p><strong>Interactive verification: (p-1)(p-2)/p² = (1-1/(p-1)²)(1-1/p)³</strong></p>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label for="single-p">Test Single Value (p):</label>
                        <input type="number" id="single-p" value="7" min="3" step="1">
                        <button class="btn" onclick="verifySingleValue()">Verify Identity</button>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label for="range-start">Range Start:</label>
                        <input type="number" id="range-start" value="3" min="3" step="1">
                    </div>
                    <div class="control-group">
                        <label for="range-end">Range End:</label>
                        <input type="number" id="range-end" value="100" min="3" step="1">
                    </div>
                    <div class="control-group">
                        <label for="range-type">Value Type:</label>
                        <select id="range-type">
                            <option value="all">All Integers</option>
                            <option value="primes">Primes Only</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn" onclick="verifyIdentityRange()">Verify Identity Over Range</button>
                </div>

                <div id="identity-results" class="results" style="display: none;">
                    <h3>Identity Verification Results</h3>
                    <div id="identity-results-content"></div>
                </div>
            </div>

            <div id="research-info" class="tab-content">
                <div class="author-info">
                    <h2>Research Documentation</h2>
                    <p><strong>Comprehensive documentation of methods, theory, and applications</strong></p>
                </div>

                <div class="detailed-info">
                    <h3>Mathematical Background</h3>
                    <p>This research centers on the algebraic identity:</p>
                    <div class="mathematical-notation">
                        <strong>(p-1)(p-2)/p² = (1-1/(p-1)²)(1-1/p)³</strong>
                    </div>
                    <p>This identity enables factorization of products crucial in twin prime research.</p>
                </div>

                <div class="detailed-info">
                    <h3>Implementation Details</h3>
                    <h4>Direct Method:</h4>
                    <pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto;">
function directProduct(primes) {
    let product = 1;
    for (const p of primes) {
        product *= (p - 1) * (p - 2) / (p * p);
    }
    return product;
}</pre>

                    <h4>Factorized Method:</h4>
                    <pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto;">
function factorizedProduct(primes) {
    let logTwinSum = 0;
    let logMertensSum = 0;
    
    for (const p of primes) {
        logTwinSum += Math.log(1 - 1/((p-1)*(p-1)));
        logMertensSum += Math.log(1 - 1/p);
    }
    
    return Math.exp(logTwinSum + 3 * logMertensSum);
}</pre>
                </div>

                <div class="detailed-info">
                    <h3>Contact & Collaboration</h3>
                    <p><strong>Author:</strong> Wessen Getachew</p>
                    <p><strong>Email:</strong> getachewwessen@gmail.com</p>
                    <p><strong>Research Context:</strong> Independent exploration of prime number computational methods</p>
                    <p><strong>Collaboration:</strong> Open to joint research projects and extensions</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variable to store current results for export
        let currentResults = null;

        // Utility functions
        function isPrime(n) {
            if (n < 2) return false;
            if (n === 2) return true;
            if (n % 2 === 0) return false;
            for (let i = 3; i * i <= n; i += 2) {
                if (n % i === 0) return false;
            }
            return true;
        }

        function generatePrimes(limit) {
            const primes = [];
            for (let i = 2; i <= limit; i++) {
                if (isPrime(i)) primes.push(i);
            }
            return primes;
        }

        function showTab(tabId) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // Core computation functions
        function directProduct(primes) {
            let product = 1;
            for (const p of primes) {
                if (p > 2) {
                    product *= (p - 1) * (p - 2) / (p * p);
                }
            }
            return product;
        }

        function factorizedProduct(primes) {
            let logTwinSum = 0;
            let logMertensSum = 0;
            
            for (const p of primes) {
                if (p > 2) {
                    logTwinSum += Math.log(1 - 1/((p-1)*(p-1)));
                    logMertensSum += Math.log(1 - 1/p);
                }
            }
            
            return Math.exp(logTwinSum + 3 * logMertensSum);
        }

        function verifyIdentity(p) {
            if (p <= 1) return { valid: false, error: "p must be > 1" };
            
            const leftSide = (p - 1) * (p - 2) / (p * p);
            const factor1 = 1 - 1/((p-1)*(p-1));
            const factor2 = Math.pow(1 - 1/p, 3);
            const rightSide = factor1 * factor2;
            
            const relativeError = Math.abs((leftSide - rightSide) / leftSide);
            
            return {
                valid: true,
                p: p,
                leftSide: leftSide,
                rightSide: rightSide,
                factor1: factor1,
                factor2: factor2,
                relativeError: relativeError,
                match: relativeError < 1e-14
            };
        }

        // Main computation function
        function computeTwinPrimeStability() {
            const range = parseInt(document.getElementById('twin-range').value);
            const method = document.getElementById('twin-method').value;
            
            document.getElementById('twin-loading').style.display = 'block';
            document.getElementById('twin-results').style.display = 'none';
            
            setTimeout(() => {
                try {
                    const primes = generatePrimes(range);
                    const results = [];
                    
                    let directResult = null;
                    let factorizedResult = null;
                    let directStable = true;
                    let factorizedStable = true;
                    
                    if (method === 'both' || method === 'direct') {
                        try {
                            directResult = directProduct(primes);
                            directStable = directResult > 1e-300 && isFinite(directResult);
                        } catch (e) {
                            directStable = false;
                        }
                    }
                    
                    if (method === 'both' || method === 'factorized') {
                        try {
                            factorizedResult = factorizedProduct(primes);
                            factorizedStable = factorizedResult > 1e-300 && isFinite(factorizedResult);
                        } catch (e) {
                            factorizedStable = false;
                        }
                    }
                    
                    // Generate comparison table for smaller ranges
                    if (primes.length <= 20) {
                        for (const p of primes) {
                            const verification = verifyIdentity(p);
                            if (verification.valid) {
                                results.push(verification);
                            }
                        }
                    }
                    
                    currentResults = {
                        type: 'twin_prime',
                        primes: primes,
                        range: range,
                        method: method,
                        directResult: directResult,
                        factorizedResult: factorizedResult,
                        directStable: directStable,
                        factorizedStable: factorizedStable,
                        verifications: results,
                        timestamp: new Date().toISOString()
                    };
                    
                    displayTwinPrimeResults(currentResults);
                    
                } catch (error) {
                    document.getElementById('twin-results-content').innerHTML = 
                        `<div style="color: red; padding: 20px;">Error: ${error.message}</div>`;
                }
                
                document.getElementById('twin-loading').style.display = 'none';
                document.getElementById('twin-results').style.display = 'block';
            }, 100);
        }

        function displayTwinPrimeResults(data) {
            const content = document.getElementById('twin-results-content');
            let html = '';
            
            // Summary statistics
            html += '<div class="results-grid">';
            html += `<div class="result-item">
                        <div class="result-value">${data.primes.length}</div>
                        <div class="result-label">Primes Analyzed</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${data.range.toLocaleString()}</div>
                        <div class="result-label">Range Limit</div>
                     </div>`;
            
            if (data.directResult !== null) {
                html += `<div class="result-item">
                            <div class="result-value">${data.directStable ? 'Stable' : 'Failed'}</div>
                            <div class="result-label">Direct Method</div>
                         </div>`;
            }
            
            if (data.factorizedResult !== null) {
                html += `<div class="result-item">
                            <div class="result-value">${data.factorizedStable ? 'Stable' : 'Failed'}</div>
                            <div class="result-label">Factorized Method</div>
                         </div>`;
            }
            html += '</div>';
            
            // Method comparison
            if (data.method === 'both') {
                html += '<h4>Method Comparison</h4>';
                html += '<table class="data-table">';
                html += '<tr><th>Method</th><th>Result</th><th>Status</th><th>Notes</th></tr>';
                
                html += '<tr>';
                html += '<td><strong>Direct Product</strong></td>';
                html += `<td>${data.directStable ? data.directResult.toExponential(6) : 'Underflow/Error'}</td>`;
                html += `<td><span class="status-badge ${data.directStable ? 'status-low' : 'status-high'}">${data.directStable ? 'Stable' : 'Failed'}</span></td>`;
                html += `<td>${data.directStable ? 'Standard multiplication works' : 'Numerical underflow detected'}</td>`;
                html += '</tr>';
                
                html += '<tr>';
                html += '<td><strong>Factorized Product</strong></td>';
                html += `<td>${data.factorizedStable ? data.factorizedResult.toExponential(6) : 'Error'}</td>`;
                html += `<td><span class="status-badge ${data.factorizedStable ? 'status-low' : 'status-high'}">${data.factorizedStable ? 'Stable' : 'Failed'}</span></td>`;
                html += `<td>${data.factorizedStable ? 'Logarithmic computation stable' : 'Unexpected error'}</td>`;
                html += '</tr>';
                
                html += '</table>';
                
                if (data.directStable && data.factorizedStable) {
                    const relativeError = Math.abs((data.directResult - data.factorizedResult) / data.directResult);
                    html += `<p><strong>Relative Error:</strong> ${relativeError.toExponential(3)} (Methods ${relativeError < 1e-10 ? 'agree' : 'differ'})</p>`;
                }
            }
            
            // Individual verification for small ranges
            if (data.verifications.length > 0) {
                html += '<h4>Individual Prime Verification</h4>';
                html += '<table class="data-table">';
                html += '<tr><th>p</th><th>Left Side</th><th>Right Side</th><th>Error</th><th>Match</th></tr>';
                
                for (const v of data.verifications) {
                    html += '<tr>';
                    html += `<td>${v.p}</td>`;
                    html += `<td>${v.leftSide.toFixed(8)}</td>`;
                    html += `<td>${v.rightSide.toFixed(8)}</td>`;
                    html += `<td>${v.relativeError.toExponential(2)}</td>`;
                    html += `<td><span class="status-badge ${v.match ? 'status-low' : 'status-high'}">${v.match ? '✓' : '✗'}</span></td>`;
                    html += '</tr>';
                }
                
                html += '</table>';
            }
            
            content.innerHTML = html;
        }

        function verifySingleValue() {
            const p = parseFloat(document.getElementById('single-p').value);
            const result = verifyIdentity(p);
            
            const content = document.getElementById('identity-results-content');
            document.getElementById('identity-results').style.display = 'block';
            
            if (!result.valid) {
                content.innerHTML = `<div style="color: red; padding: 20px;">Error: ${result.error}</div>`;
                return;
            }
            
            currentResults = {
                type: 'single_verification',
                result: result,
                timestamp: new Date().toISOString()
            };
            
            let html = '<div class="results-grid">';
            html += `<div class="result-item">
                        <div class="result-value">${p}</div>
                        <div class="result-label">Test Value (p)</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${result.leftSide.toFixed(8)}</div>
                        <div class="result-label">Left Side</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${result.rightSide.toFixed(8)}</div>
                        <div class="result-label">Right Side</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${result.relativeError.toExponential(2)}</div>
                        <div class="result-label">Relative Error</div>
                     </div>`;
            html += '</div>';
            
            html += '<h4>Detailed Calculation</h4>';
            html += '<table class="data-table">';
            html += '<tr><th>Component</th><th>Formula</th><th>Value</th></tr>';
            html += `<tr><td>Left Side</td><td>(${p}-1)(${p}-2)/${p}²</td><td>${result.leftSide}</td></tr>`;
            html += `<tr><td>Factor 1</td><td>1 - 1/(${p}-1)²</td><td>${result.factor1}</td></tr>`;
            html += `<tr><td>Factor 2</td><td>(1 - 1/${p})³</td><td>${result.factor2}</td></tr>`;
            html += `<tr><td>Right Side</td><td>Factor 1 × Factor 2</td><td>${result.rightSide}</td></tr>`;
            html += '</table>';
            
            html += `<div class="detailed-info" style="margin-top: 20px;">`;
            html += `<h4>Verification: ${result.match ? 'PASSED ✓' : 'FAILED ✗'}</h4>`;
            html += `<p>The identity ${result.match ? 'holds' : 'does not hold'} for p = ${p} with relative error ${result.relativeError.toExponential(3)}.</p>`;
            html += '</div>';
            
            content.innerHTML = html;
        }

        function verifyIdentityRange() {
            const start = parseInt(document.getElementById('range-start').value);
            const end = parseInt(document.getElementById('range-end').value);
            const type = document.getElementById('range-type').value;
            
            if (start >= end) {
                alert('Start must be less than end');
                return;
            }
            
            const values = [];
            if (type === 'primes') {
                for (let i = start; i <= end; i++) {
                    if (isPrime(i)) values.push(i);
                }
            } else {
                for (let i = start; i <= end; i++) {
                    values.push(i);
                }
            }
            
            const results = values.map(verifyIdentity).filter(r => r.valid);
            
            currentResults = {
                type: 'range_verification',
                start: start,
                end: end,
                valueType: type,
                results: results,
                timestamp: new Date().toISOString()
            };
            
            const content = document.getElementById('identity-results-content');
            document.getElementById('identity-results').style.display = 'block';
            
            let html = '<div class="results-grid">';
            html += `<div class="result-item">
                        <div class="result-value">${results.length}</div>
                        <div class="result-label">Values Tested</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${results.filter(r => r.match).length}</div>
                        <div class="result-label">Verified</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${Math.max(...results.map(r => r.relativeError)).toExponential(2)}</div>
                        <div class="result-label">Max Error</div>
                     </div>`;
            html += `<div class="result-item">
                        <div class="result-value">${(results.map(r => r.relativeError).reduce((a,b) => a+b, 0) / results.length).toExponential(2)}</div>
                        <div class="result-label">Avg Error</div>
                     </div>`;
            html += '</div>';
            
            if (results.length <= 50) {
                html += '<h4>Detailed Results</h4>';
                html += '<table class="data-table">';
                html += '<tr><th>Value</th><th>Left Side</th><th>Right Side</th><th>Error</th><th>Status</th></tr>';
                
                for (const r of results) {
                    html += '<tr>';
                    html += `<td>${r.p}</td>`;
                    html += `<td>${r.leftSide.toFixed(6)}</td>`;
                    html += `<td>${r.rightSide.toFixed(6)}</td>`;
                    html += `<td>${r.relativeError.toExponential(1)}</td>`;
                    html += `<td><span class="status-badge ${r.match ? 'status-low' : 'status-high'}">${r.match ? '✓' : '✗'}</span></td>`;
                    html += '</tr>';
                }
                
                html += '</table>';
            }
            
            const allMatch = results.every(r => r.match);
            html += `<div class="detailed-info" style="margin-top: 20px;">`;
            html += `<h4>Overall Result: ${allMatch ? 'ALL VERIFIED ✓' : 'SOME FAILED ✗'}</h4>`;
            html += `<p>Identity verification for ${type} from ${start} to ${end}: ${results.filter(r => r.match).length}/${results.length} passed.</p>`;
            html += '</div>';
            
            content.innerHTML = html;
        }

        // Export functionality
        function exportResults(format) {
            if (!currentResults) {
                alert('No results to export. Please run an analysis first.');
                return;
            }

            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            let filename, content, mimeType;

            switch (format) {
                case 'csv':
                    ({ filename, content, mimeType } = exportToCSV(currentResults, timestamp));
                    break;
                case 'json':
                    ({ filename, content, mimeType } = exportToJSON(currentResults, timestamp));
                    break;
                case 'report':
                    ({ filename, content, mimeType } = exportToReport(currentResults, timestamp));
                    break;
                default:
                    alert('Unknown export format');
                    return;
            }

            downloadFile(filename, content, mimeType);
        }

        function exportToCSV(data, timestamp) {
            let csv = '';
            let filename = `prime-research-${data.type}-${timestamp}.csv`;

            if (data.type === 'twin_prime') {
                csv = 'Prime,Direct_Method_Term,Factorized_Method_Term,Left_Side,Right_Side,Relative_Error\n';
                for (const verification of data.verifications) {
                    const directTerm = data.directStable ? ((verification.p - 1) * (verification.p - 2) / (verification.p * verification.p)) : 'N/A';
                    const factorizedTerm = data.factorizedStable ? verification.rightSide : 'N/A';
                    csv += `${verification.p},${directTerm},${factorizedTerm},${verification.leftSide},${verification.rightSide},${verification.relativeError}\n`;
                }
            } else if (data.type === 'range_verification') {
                csv = 'Value,Left_Side,Right_Side,Factor1,Factor2,Relative_Error,Match\n';
                for (const result of data.results) {
                    csv += `${result.p},${result.leftSide},${result.rightSide},${result.factor1},${result.factor2},${result.relativeError},${result.match}\n`;
                }
            } else if (data.type === 'single_verification') {
                csv = 'Property,Value\n';
                csv += `Value_p,${data.result.p}\n`;
                csv += `Left_Side,${data.result.leftSide}\n`;
                csv += `Right_Side,${data.result.rightSide}\n`;
                csv += `Factor1,${data.result.factor1}\n`;
                csv += `Factor2,${data.result.factor2}\n`;
                csv += `Relative_Error,${data.result.relativeError}\n`;
                csv += `Match,${data.result.match}\n`;
            }

            return { filename, content: csv, mimeType: 'text/csv' };
        }

        function exportToJSON(data, timestamp) {
            const filename = `prime-research-${data.type}-${timestamp}.json`;
            const content = JSON.stringify(data, null, 2);
            return { filename, content, mimeType: 'application/json' };
        }

        function exportToReport(data, timestamp) {
            const filename = `prime-research-report-${data.type}-${timestamp}.txt`;
            let content = `Prime Number Research Platform - Analysis Report\n`;
            content += `Generated: ${new Date().toLocaleString()}\n`;
            content += `Research by: Wessen Getachew (getachewwessen@gmail.com)\n`;
            content += `${'='.repeat(60)}\n\n`;

            content += `MATHEMATICAL IDENTITY: (p-1)(p-2)/p² = (1-1/(p-1)²)(1-1/p)³\n\n`;

            if (data.type === 'twin_prime') {
                content += `TWIN PRIME STABILITY ANALYSIS\n`;
                content += `Range: up to ${data.range}\n`;
                content += `Primes analyzed: ${data.primes.length}\n`;
                content += `Method: ${data.method}\n\n`;

                if (data.method === 'both') {
                    content += `RESULTS COMPARISON:\n`;
                    content += `Direct Method: ${data.directStable ? 'Stable' : 'Failed'}\n`;
                    if (data.directStable) {
                        content += `  Result: ${data.directResult.toExponential(6)}\n`;
                    }
                    content += `Factorized Method: ${data.factorizedStable ? 'Stable' : 'Failed'}\n`;
                    if (data.factorizedStable) {
                        content += `  Result: ${data.factorizedResult.toExponential(6)}\n`;
                    }
                    if (data.directStable && data.factorizedStable) {
                        const relError = Math.abs((data.directResult - data.factorizedResult) / data.directResult);
                        content += `  Relative error between methods: ${relError.toExponential(3)}\n`;
                    }
                }

                if (data.verifications.length > 0) {
                    content += `\nINDIVIDUAL PRIME VERIFICATION:\n`;
                    for (const v of data.verifications) {
                        content += `p=${v.p}: ${v.match ? 'VERIFIED' : 'FAILED'} (error: ${v.relativeError.toExponential(2)})\n`;
                    }
                }
            }

            content += `\nABOUT THIS RESEARCH:\n`;
            content += `This analysis demonstrates a novel algebraic identity that enables\n`;
            content += `numerically stable computation of twin prime products that would\n`;
            content += `otherwise underflow in standard floating-point arithmetic.\n\n`;
            content += `For more information and interactive tools, visit:\n`;
            content += `Prime Number Research Platform by Wessen Getachew\n`;

            return { filename, content, mimeType: 'text/plain' };
        }

        function downloadFile(filename, content, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Prime Number Research Platform initialized');
        });
    </script>
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Twin Prime Identity Verifier</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.2em;
            opacity: 0.9;
            font-style: italic;
        }
        
        .algorithm-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.4;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        label {
            font-weight: bold;
        }
        
        input, button {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }
        
        input {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            width: 100px;
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 120px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .mode-toggle {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }
        
        .results {
            display: grid;
            gap: 20px;
            margin-top: 30px;
        }
        
        .result-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #4ecdc4;
        }
        
        .result-header {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #4ecdc4;
            text-align: center;
        }
        
        .calculation-steps {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.3;
        }
        
        .identity-check {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
        }
        
        .identity-fail {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid #e74c3c;
        }
        
        .summary-table {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9em;
        }
        
        th {
            background: rgba(255, 255, 255, 0.2);
            font-weight: bold;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2em;
        }
        
        .exact-mode {
            border-left-color: #f39c12;
        }
        
        .exact-mode .identity-check {
            background: rgba(243, 156, 18, 0.2);
            border-color: #f39c12;
        }
        
        .highlight {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Twin Prime Identity Verifier</h1>
        <div class="subtitle">Finite-Cutoff Modular-Hardy-Littlewood Equivalence</div>
        
        <div class="algorithm-display">
            <strong>Identity:</strong> R<sub>modular</sub>(p<sub>max</sub>) = ¼ · C<sub>twin</sub>(p<sub>max</sub>) · (M<sub>no-two</sub>(p<sub>max</sub>))<sup>3</sup>
            <br><br>
            <strong>Where:</strong><br>
            R<sub>modular</sub>(p<sub>max</sub>) = ¼ ∏<sub>3≤p≤p<sub>max</sub></sub> [(p-1)(p-2)/p²]<br>
            C<sub>twin</sub>(p<sub>max</sub>) = ∏<sub>3≤p≤p<sub>max</sub></sub> [1 - 1/(p-1)²]<br>
            M<sub>no-two</sub>(p<sub>max</sub>) = ∏<sub>3≤p≤p<sub>max</sub></sub> [1 - 1/p]
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="pmax">p<sub>max</sub>:</label>
                <input type="number" id="pmax" value="5" min="3" max="97">
            </div>
            <div class="control-group">
                <label for="testRange">Test Range:</label>
                <input type="number" id="startRange" value="3" min="3" max="97" placeholder="Start">
                <input type="number" id="endRange" value="13" min="3" max="97" placeholder="End">
            </div>
            <button onclick="testSingle()">Test Single</button>
            <button onclick="testRange()">Test Range</button>
            <button class="mode-toggle" onclick="toggleMode()" id="modeToggle">Numeric Mode</button>
        </div>
        
        <div id="results" class="results"></div>
    </div>

    <script>
        let exactMode = false;
        
        function isPrime(n) {
            if (n < 2) return false;
            if (n === 2) return true;
            if (n % 2 === 0) return false;
            for (let i = 3; i * i <= n; i += 2) {
                if (n % i === 0) return false;
            }
            return true;
        }
        
        function getPrimesInRange(start, end) {
            const primes = [];
            for (let i = Math.max(start, 3); i <= end; i++) {
                if (isPrime(i)) primes.push(i);
            }
            return primes;
        }
        
        function gcd(a, b) {
            while (b !== 0) {
                const temp = b;
                b = a % b;
                a = temp;
            }
            return Math.abs(a);
        }
        
        // Exact integer arithmetic version (Algorithm 2)
        function verifyIdentityExact(pmax) {
            const primes = getPrimesInRange(3, pmax);
            
            // Initialize integer numerators/denominators
            let NR = 1n, DR = 1n;  // For ∏(p-1)(p-2)/p²
            let NC = 1n, DC = 1n;  // For ∏p(p-2)/(p-1)² 
            let NM = 1n, DM = 1n;  // For ∏(p-1)/p
            
            const steps = [];
            steps.push(`Exact integer arithmetic for p_max = ${pmax}`);
            steps.push(`Primes: ${primes.join(', ')}`);
            steps.push('');
            
            for (const p of primes) {
                const pBig = BigInt(p);
                
                // R component: (p-1)(p-2)/p²
                NR *= (pBig - 1n) * (pBig - 2n);
                DR *= pBig * pBig;
                
                // C component: p(p-2)/(p-1)² (since 1-1/(p-1)² = p(p-2)/(p-1)²)
                NC *= pBig * (pBig - 2n);
                DC *= (pBig - 1n) * (pBig - 1n);
                
                // M component: (p-1)/p
                NM *= (pBig - 1n);
                DM *= pBig;
                
                steps.push(`p = ${p}:`);
                steps.push(`  R: ${NR}/${DR}`);
                steps.push(`  C: ${NC}/${DC}`);
                steps.push(`  M: ${NM}/${DM}`);
                
                // Reduce fractions periodically to keep numbers manageable
                const gcdR = gcd(Number(NR % 1000000n), Number(DR % 1000000n));
                const gcdC = gcd(Number(NC % 1000000n), Number(DC % 1000000n));
                const gcdM = gcd(Number(NM % 1000000n), Number(DM % 1000000n));
                
                if (gcdR > 1) { NR /= BigInt(gcdR); DR /= BigInt(gcdR); }
                if (gcdC > 1) { NC /= BigInt(gcdC); DC /= BigInt(gcdC); }
                if (gcdM > 1) { NM /= BigInt(gcdM); DM /= BigInt(gcdM); }
            }
            
            steps.push('');
            steps.push('Final fractions:');
            steps.push(`R_prod = ${NR}/${DR}`);
            steps.push(`C = ${NC}/${DC}`);
            steps.push(`M = ${NM}/${DM}`);
            steps.push('');
            
            // Test: (1/4) * (NR/DR) == (1/4) * (NC/DC) * (NM/DM)³
            // Simplifies to: NR * DC * DM³ == DR * NC * NM³
            const leftSide = NR * DC * DM * DM * DM;
            const rightSide = DR * NC * NM * NM * NM;
            
            const equal = leftSide === rightSide;
            
            steps.push('Exact equality test:');
            steps.push(`Left:  NR × DC × DM³ = ${NR} × ${DC} × ${DM}³`);
            steps.push(`Right: DR × NC × NM³ = ${DR} × ${NC} × NM³`);
            steps.push(`Left  = ${leftSide}`);
            steps.push(`Right = ${rightSide}`);
            steps.push(`Equal = ${equal}`);
            
            return {
                pmax: pmax,
                equal: equal,
                steps: steps,
                leftSide: leftSide.toString(),
                rightSide: rightSide.toString(),
                fractions: {
                    R: `${NR}/${DR}`,
                    C: `${NC}/${DC}`,
                    M: `${NM}/${DM}`
                }
            };
        }
        
        // Numeric version (Algorithm 1)
        function verifyIdentityNumeric(pmax, tolerance = 1e-15) {
            const primes = getPrimesInRange(3, pmax);
            
            let R = 0.25; // Start with 1/4
            let C = 1.0;
            let M = 1.0;
            
            const steps = [];
            steps.push(`Numeric verification for p_max = ${pmax}`);
            steps.push(`Tolerance = ${tolerance}`);
            steps.push(`Primes: ${primes.join(', ')}`);
            steps.push('');
            
            for (const p of primes) {
                const rFactor = (p-1) * (p-2) / (p * p);
                const cFactor = 1 - 1/((p-1) * (p-1));
                const mFactor = 1 - 1/p;
                
                R *= rFactor;
                C *= cFactor;
                M *= mFactor;
                
                steps.push(`p = ${p}:`);
                steps.push(`  R factor: (${p}-1)(${p}-2)/${p}² = ${rFactor.toFixed(8)}, R = ${R.toFixed(12)}`);
                steps.push(`  C factor: 1-1/(${p}-1)² = ${cFactor.toFixed(8)}, C = ${C.toFixed(8)}`);
                steps.push(`  M factor: 1-1/${p} = ${mFactor.toFixed(8)}, M = ${M.toFixed(8)}`);
                steps.push('');
            }
            
            const rightSide = 0.25 * C * Math.pow(M, 3);
            const ratio = R / rightSide;
            const passed = Math.abs(ratio - 1) <= tolerance;
            
            steps.push('Final calculation:');
            steps.push(`R_modular = ${R.toFixed(15)}`);
            steps.push(`Right side = (1/4) × ${C.toFixed(8)} × ${M.toFixed(8)}³ = ${rightSide.toFixed(15)}`);
            steps.push(`Ratio ρ = ${ratio.toFixed(12)}`);
            steps.push(`|ρ - 1| = ${Math.abs(ratio - 1).toExponential(3)}`);
            steps.push(`Pass: ${passed} (tolerance: ${tolerance})`);
            
            return {
                pmax: pmax,
                R: R,
                C: C,
                M: M,
                rightSide: rightSide,
                ratio: ratio,
                passed: passed,
                steps: steps
            };
        }
        
        function displayExactResult(result) {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result-card exact-mode';
            
            resultDiv.innerHTML = `
                <div class="result-header">🔬 Exact Integer Test: p<sub>max</sub> = ${result.pmax}</div>
                
                <div class="calculation-steps">
                    ${result.steps.join('<br>')}
                </div>
                
                <div class="identity-check ${result.equal ? '' : 'identity-fail'}">
                    ${result.equal ? '✅ EXACT IDENTITY VERIFIED!' : '❌ EXACT IDENTITY FAILED'}
                    <br><br>
                    <div class="highlight">Algorithm 2: Exact Integer Arithmetic</div>
                    <br>
                    Final Fractions:<br>
                    R<sub>prod</sub> = ${result.fractions.R}<br>
                    C<sub>twin</sub> = ${result.fractions.C}<br>
                    M<sub>no-two</sub> = ${result.fractions.M}
                </div>
            `;
            
            return resultDiv;
        }
        
        function displayNumericResult(result) {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result-card';
            
            resultDiv.innerHTML = `
                <div class="result-header"> Numeric Test: p<sub>max</sub> = ${result.pmax}</div>
                
                <div class="calculation-steps">
                    ${result.steps.join('<br>')}
                </div>
                
                <div class="identity-check ${result.passed ? '' : 'identity-fail'}">
                    ${result.passed ? '✅ NUMERIC IDENTITY VERIFIED!' : '❌ NUMERIC IDENTITY FAILED'}
                    <br><br>
                    <div class="highlight">Algorithm 1: Numeric Verification</div>
                    <br>
                    R<sub>modular</sub> = ${result.R.toFixed(15)}<br>
                    Right Side = ${result.rightSide.toFixed(15)}<br>
                    Ratio ρ = ${result.ratio.toFixed(12)}
                </div>
            `;
            
            return resultDiv;
        }
        
        function testSingle() {
            const pmax = parseInt(document.getElementById('pmax').value);
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.innerHTML = '<div class="loading"> Computing...</div>';
            
            setTimeout(() => {
                try {
                    if (exactMode) {
                        const result = verifyIdentityExact(pmax);
                        resultsDiv.innerHTML = '';
                        resultsDiv.appendChild(displayExactResult(result));
                    } else {
                        const result = verifyIdentityNumeric(pmax);
                        resultsDiv.innerHTML = '';
                        resultsDiv.appendChild(displayNumericResult(result));
                    }
                } catch (error) {
                    resultsDiv.innerHTML = `<div class="result-card identity-fail">Error: ${error.message}<br>Stack: ${error.stack}</div>`;
                }
            }, 100);
        }
        
        function testRange() {
            const start = parseInt(document.getElementById('startRange').value);
            const end = parseInt(document.getElementById('endRange').value);
            const resultsDiv = document.getElementById('results');
            
            if (start > end) {
                resultsDiv.innerHTML = '<div class="result-card identity-fail">Error: Start value must be ≤ End value</div>';
                return;
            }
            
            resultsDiv.innerHTML = '<div class="loading"> Computing range...</div>';
            
            setTimeout(() => {
                try {
                    const results = [];
                    
                    for (let pmax = start; pmax <= end; pmax++) {
                        if (isPrime(pmax)) {
                            if (exactMode) {
                                results.push(verifyIdentityExact(pmax));
                            } else {
                                results.push(verifyIdentityNumeric(pmax));
                            }
                        }
                    }
                    
                    resultsDiv.innerHTML = '';
                    
                    // Summary table
                    const summaryDiv = document.createElement('div');
                    const modeText = exactMode ? 'Exact' : 'Numeric';
                    summaryDiv.innerHTML = `
                        <div class="result-header"> ${modeText} Range Summary: p<sub>max</sub> ${start} to ${end}</div>
                        <div class="summary-table">
                            <table>
                                <tr>
                                    <th>p<sub>max</sub></th>
                                    <th>${exactMode ? 'Exact Equal' : 'Ratio ρ'}</th>
                                    <th>Status</th>
                                    ${!exactMode ? '<th>R<sub>modular</sub></th><th>Right Side</th>' : ''}
                                </tr>
                                ${results.map(r => `
                                    <tr>
                                        <td>${r.pmax}</td>
                                        <td>${exactMode ? (r.equal ? 'TRUE' : 'FALSE') : r.ratio.toFixed(6)}</td>
                                        <td>${exactMode ? (r.equal ? '✅' : '❌') : (r.passed ? '✅' : '❌')}</td>
                                        ${!exactMode ? `<td>${r.R.toFixed(8)}</td><td>${r.rightSide.toFixed(8)}</td>` : ''}
                                    </tr>
                                `).join('')}
                            </table>
                        </div>
                    `;
                    
                    resultsDiv.appendChild(summaryDiv);
                    
                    // Individual results
                    results.forEach(result => {
                        if (exactMode) {
                            resultsDiv.appendChild(displayExactResult(result));
                        } else {
                            resultsDiv.appendChild(displayNumericResult(result));
                        }
                    });
                    
                } catch (error) {
                    resultsDiv.innerHTML = `<div class="result-card identity-fail">Error: ${error.message}</div>`;
                }
            }, 100);
        }
        
        function toggleMode() {
            exactMode = !exactMode;
            const button = document.getElementById('modeToggle');
            button.textContent = exactMode ? 'Exact Mode' : 'Numeric Mode';
            button.style.background = exactMode ? 
                'linear-gradient(45deg, #f39c12, #e67e22)' : 
                'linear-gradient(45deg, #4ecdc4, #44a08d)';
        }
        
        // Initialize with p_max = 5
        document.addEventListener('DOMContentLoaded', function() {
            testSingle();
        });
    </script>
</body>
</html>
